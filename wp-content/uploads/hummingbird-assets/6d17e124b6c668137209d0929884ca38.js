/**handles:ga_appointments_calendar_script,ga_appointments_schedule_script**/
jQuery(window).on("load",function(){"function"==typeof jQuery.fn.chosen&&jQuery(".chosen-select").chosen()}),jQuery(document).bind("gform_post_render",function(){"function"==typeof jQuery.fn.chosen&&jQuery(".chosen-select").chosen()}),jQuery(".user_appointment_status_set").on("click",function(e){e.preventDefault();var e=jQuery(this).attr("app-id"),a,t,n,i,e='<div id="ga_model" class="ga_modal_bg"><div class="ga_dialog"><div class="ga_dialog_wrapper"><div class="ga_modal_wrapper"><div class="ga_modal_container"><span title="Close" class="ga_close ga_remove cancel_user_app_pending"></span><h3 class="modal-title">'+jQuery(this).attr("title")+'</h3><div class="hr"></div><form id="ga_user_set_appointment_pending" action="" method="post" class="clearfix"><div class="ajax-response"></div><input type="hidden" name="app-id" value="'+e+'"><input type="hidden" name="action" value="'+"ga_user_set_appointment_pending"+'">'+""+'<div class="ga_modal_footer"><button type="submit" class="ga-button">'+jQuery(this).attr("button-text")+'</button></div></form><div class="modal_overlay"></div></div></div></div></div></div>';jQuery("#ga_appointment_modal").hide().html(e).fadeIn(100,function(){jQuery("html, body").addClass("ga_modal_open")})}),jQuery(document).ready(function(){function o(e){jQuery("#gappointments_calendar").find(".ga_monthly_schedule_wrapper").html(e)}function j(){var e=jQuery(".ginput_appointment_cost_input"),a=0,t=jQuery("#service-working-days td.day_available").attr("service_cost"),n=jQuery("#service-working-days td.ga_date_slots.selected"),i=jQuery("#gappointments_calendar_slots label.time_selected"),o=jQuery("#ga_selected_bookings .ga_selected_booking input.ga_selected_booking_date");o&&o.length?jQuery("#ga_selected_bookings .ga_selected_booking input.ga_selected_booking_date").each(function(){a+=Math.max(0,parseFloat(jQuery(this).attr("slot_cost")))}):n&&n.length&&jQuery.isNumeric(t)?a=t:i&&i.length&&(a=i.attr("slot_cost")),e.each(function(){jQuery(this).val(a).change()}),"function"==typeof gformInitPriceFields&&gformInitPriceFields()}function s(e,a){var e=new RegExp(e.replace(/[/\\]/g,"\\$&"),"g");return match=a.search(e)}jQuery("body").on("change",".appointment_service_id",function(){var t=jQuery(".appointment_provider_id");jQuery(".appointment_booking_date, .appointment_booking_time").val(""),jQuery("#ga_selected_bookings").fadeOut(300,function(){jQuery(this).html("").removeAttr("style")}),jQuery(".ga_monthly_schedule_wrapper").addClass("ga_spinner");var e=jQuery(this).val().htmlEntitiesEncode(),a=jQuery(this).attr("form_id"),n=t.val().htmlEntitiesEncode(),i;t.each(function(){jQuery(this).html('<option value="">Please wait...</option>'),jQuery(this).hasClass("chosen-select")&&jQuery(this).trigger("chosen:updated")}),jQuery.post(ga_calendar_services_obj.ajax_url,{action:"ga_calendar_select_service",provider:n,service:e,form_id:a},function(e){var a;void 0!==e&&1==e.success&&(t.each(function(){jQuery(this).html(e.data.providers),jQuery(this).hasClass("chosen-select")&&jQuery(this).trigger("chosen:updated")}),jQuery("#gappointments_calendar").find(".ga_monthly_schedule_wrapper").html(e.data.calendar),-1===s(n,e.data.providers)&&jQuery(this).change(),jQuery(".ga_monthly_schedule_wrapper").removeClass("ga_spinner"),j())})}),jQuery("body").on("change",".appointment_provider_id",function(){jQuery(".appointment_booking_date, .appointment_booking_time").val(""),jQuery("#ga_selected_bookings").fadeOut(300,function(){jQuery(this).html("").removeAttr("style")}),jQuery(".ga_monthly_schedule_wrapper").addClass("ga_spinner");var e=jQuery(this).val().htmlEntitiesEncode(),a=jQuery(".appointment_service_id").val().htmlEntitiesEncode(),t=jQuery(this).attr("form_id"),n;jQuery.post(ga_calendar_providers_obj.ajax_url,{action:"ga_calendar_select_provider",service:a,provider:e,form_id:t},function(e){o(e),jQuery(".ga_monthly_schedule_wrapper").removeClass("ga_spinner"),j()})}),jQuery("body").on("click","#ga_calendar_prev_month",function(){jQuery(".appointment_booking_date, .appointment_booking_time").val(""),jQuery(".ga_monthly_schedule_wrapper").addClass("ga_spinner");var e=jQuery(this).attr("date-go"),a=jQuery(this).attr("service_id"),t=jQuery(this).attr("provider_id"),n=jQuery("#ga_appointments_calendar").attr("form_id"),i;jQuery.post(ga_calendar_prev_month_obj.ajax_url,{action:"ga_calendar_prev_month",current_month:e,service_id:a,provider_id:t,form_id:n},function(e){o(e),jQuery(".ga_monthly_schedule_wrapper").removeClass("ga_spinner")})}),jQuery("body").on("click","#ga_calendar_next_month",function(){jQuery(".appointment_booking_date, .appointment_booking_time").val(""),jQuery(".ga_monthly_schedule_wrapper").addClass("ga_spinner");var e=jQuery(this).attr("date-go"),a=jQuery(this).attr("service_id"),t=jQuery(this).attr("provider_id"),n=jQuery("#ga_appointments_calendar").attr("form_id"),i;jQuery.post(ga_calendar_next_month_obj.ajax_url,{action:"ga_calendar_next_month",current_month:e,service_id:a,provider_id:t,form_id:n},function(e){o(e),jQuery(".ga_monthly_schedule_wrapper").removeClass("ga_spinner")})}),jQuery("body").on("click","#service-working-days td.day_available",function(e){e.preventDefault();var a=jQuery(this).attr("date-go"),n,i,o,s,r,t,d,_,l,c,p,u,e,m,g;if(jQuery(".appointment_booking_date, .appointment_booking_time").val(""),jQuery(this).hasClass("selected")){var m=jQuery(this);return jQuery("#gappointments_calendar_slots").slideUp(0,function(){jQuery(this).html("")}),jQuery(m).removeClass("selected"),void j()}if(jQuery("#service-working-days td").each(function(){jQuery(this).removeClass("selected")}),jQuery(this).addClass("selected"),jQuery(".appointment_booking_date").val(jQuery(this).attr("date-go")),jQuery(this).hasClass("ga_date_slots"))return jQuery(".appointment_booking_time").val(jQuery(this).attr("date-go")),"enabled"==jQuery(this).attr("multi-select")&&(n=!0,i=jQuery("#ga_selected_bookings .ga_selected_booking"),o=jQuery(this).attr("select-total"),s=jQuery(this).attr("capacity"),r=jQuery(this).attr("no_double"),t=jQuery(this).attr("service_cost"),_=jQuery(".appointment_booking_date").val(),l=jQuery(".appointment_booking_time").val(),c=_+" "+l,p=0,jQuery(i).each(function(){var e,a,t=jQuery(this).find(".ga_selected_booking_date").val()+" "+jQuery(this).find(".ga_selected_booking_time").val();i.length>=o?n=!1:"yes"==r?t==c&&(n=!1):(t==c&&p++,s<=p&&(n=!1))}),n&&(u=jQuery(this).attr("lang_slot"),e=jQuery(".appointment_booking_date").attr("name").replace("[date]","[bookings][date][]"),m=jQuery(".appointment_booking_date").attr("name").replace("[date]","[bookings][time][]"),jQuery('<div class="ga_selected_booking"><div class="ga_delete_booking"><i class="fa fa-times-circle"></i></div><input type="hidden" class="ga_hidden_input ga_selected_booking_date" name="'+e+'" value="'+_+'" slot_cost="'+t+'"><input type="hidden" class="ga_hidden_input ga_selected_booking_time" name="'+m+'" value="'+l+'" slot_cost="'+t+'">'+u+"</div></div>").hide().appendTo("#ga_selected_bookings").fadeIn(700))),void j();jQuery("#gappointments_calendar_slots").each(function(){jQuery(this).remove()}),jQuery(this).parent("tr").after('<tr id="gappointments_calendar_slots"><td colspan="7" class="calendar_slots"><div class="calendar_time_slots"><div class="app_hours_loading"><div class="ajax-spinner-bars"> <div class="bar-1"></div><div class="bar-2"></div><div class="bar-3"></div><div class="bar-4"></div><div class="bar-5"></div><div class="bar-6"></div><div class="bar-7"></div><div class="bar-8"></div><div class="bar-9"></div><div class="bar-10"></div><div class="bar-11"></div><div class="bar-12"></div><div class="bar-13"></div><div class="bar-14"></div><div class="bar-15"></div><div class="bar-16"></div></div></div></div></td></tr>'),setTimeout(function(){var e=jQuery("#"+a).html();jQuery("#gappointments_calendar_slots .calendar_time_slots").html(e)},500)}),jQuery("body").on("click","#ga_model .ga_modal_wrapper .ga_remove, form#ga_cancel_appointment .ga_btn_close, form#ga_reschedule_appointment .ga_btn_close",function(e){e.preventDefault(),jQuery(this).parents("#ga_model").fadeIn(100,function(){jQuery(this).remove(),jQuery("html, body").removeClass("ga_modal_open")})}),jQuery("body").on("click","#ga_user_set_appointment_pending .ga_btn_close",function(e){e.preventDefault(),jQuery(this).parents("#ga_model").fadeIn(100,function(){jQuery(this).remove(),jQuery("html, body").removeClass("ga_modal_open")});var a=jQuery("#sel-"+jQuery(this).attr("app-id"));a.addClass("user_appointment_status_set_hide"),a.unbind();var e=jQuery(a).parent().find("span");e.removeClass("appointment_status_change_span"),e.html(jQuery(this).attr("pending-string")),e.removeClass("appointment-status-green"),e.addClass("appointment-status-yellow"),e.show(),jQuery("#sel-"+jQuery(".ga_btn_close").attr("app-id")).remove(),a.remove()}),jQuery("body").on("click",".appointment-status .appointment-action",function(e){e.preventDefault();var a=jQuery(this).attr("app-id"),t=jQuery(this).attr("title"),n,i="ga_cancel_appointment",o='<textarea name="ga_cancel_message" placeholder="'+jQuery(this).attr("optional_text")+'"></textarea><div class="hr"></div>',e=jQuery(this).text(),i,t,i,o,e;jQuery(this).hasClass("provider-cancel")&&(i="ga_provider_cancel_appointment"),jQuery(this).hasClass("provider-confirm")&&(t=jQuery(this).attr("title"),i="ga_provider_confirm",o="",e=jQuery(this).text());var e='<div id="ga_model" class="ga_modal_bg"><div class="ga_dialog"><div class="ga_dialog_wrapper"><div class="ga_modal_wrapper"><div class="ga_modal_container"><span title="Close" class="ga_close ga_remove"></span><h3 class="modal-title">'+t+'</h3><div class="hr"></div><form id="ga_cancel_appointment" action="" method="post" class="clearfix"><div class="ajax-response"></div><input type="hidden" name="app-id" value="'+a+'"><input type="hidden" name="action" value="'+i+'">'+o+'<div class="ga_modal_footer"><button type="submit" class="ga-button">'+e+'</button></div></form><div class="modal_overlay"></div></div></div></div></div></div>';jQuery("#ga_appointment_modal").hide().html(e).fadeIn(100,function(){jQuery("html, body").addClass("ga_modal_open")}),window.appointmentID=jQuery(this).parent(".appointment-status")}),jQuery("body").on("click",".appointment-status .reschedule-appointment-action",function(e){e.preventDefault();var a=jQuery(this).attr("app-id"),t=jQuery(this).attr("title"),n="ga_reschedule_appointment",i="",o=jQuery(this).text(),s;jQuery.post(ga_get_calendar_obj.ajax_url,{action:"ga_get_calendar",app_id:a},function(e){void 0!==e&&(i=e)}).fail(function(){n=!(i="<div>Error</div>")}).done(function(){var e='<div id="ga_model" class="ga_modal_bg"><div class="ga_dialog"><div class="ga_dialog_wrapper"><div class="ga_modal_wrapper"><div class="ga_modal_container"><span title="Close" class="ga_close ga_remove"></span><h3 class="modal-title">'+t+'</h3><div class="hr"></div><form id="ga_reschedule_appointment" action="" method="post" class="clearfix"><div class="ajax-response"></div><input type="hidden" name="app-id" value="'+a+'"><input type="hidden" name="action" value="'+n+'">'+i+'<div class="ga_modal_footer"><button type="submit" class="ga-button">'+o+'</button></div></form><div class="modal_overlay"></div></div></div></div></div></div>';jQuery("#ga_appointment_modal").hide().html(e).fadeIn(100,function(){jQuery("html, body").addClass("ga_modal_open")})}),window.appointmentID=jQuery(this).parent(".appointment-status")}),jQuery(document).on("submit","form#ga_cancel_appointment",function(e){e.preventDefault();var a=jQuery(this),t=a.find("input[name=action]").val();a.parent(".ga_modal_container").find(".modal_overlay").show();var e=jQuery("form#ga_cancel_appointment").serialize();jQuery.post(ga_update_appointment_status_obj.ajax_url,e,function(e){void 0!==e&&(a.parent(".ga_modal_container").find(".modal_overlay").hide(),0==e.success&&jQuery("form#ga_cancel_appointment").html(e.data.message),1==e.success&&(jQuery("form#ga_cancel_appointment").html(e.data.message),jQuery(window.appointmentID).html(e.data.app_status)))}).fail(function(){jQuery("form#ga_cancel_appointment .ajax-response").html('<div class="ga_alert ga_alert_danger">Error sending form!</div>'),a.parent(".ga_modal_container").find(".modal_overlay").hide()})}),jQuery(document).on("submit","form#ga_user_set_appointment_pending",function(e){e.preventDefault();var a=jQuery(this),t=a.find("input[name=action]").val();a.parent(".ga_modal_container").find(".modal_overlay").show();var e=jQuery("form#ga_user_set_appointment_pending").serialize();jQuery.post(ga_user_set_appointment_pending_obj.ajax_url,e,function(e){void 0!==e&&(a.parent(".ga_modal_container").find(".modal_overlay").hide(),0==e.success&&jQuery("form#ga_user_set_appointment_pending").html(e.data.message),1==e.success&&(console.log("nustatytas"),jQuery("form#ga_user_set_appointment_pending").html(e.data.message),jQuery(window.appointmentID).html(e.data.app_status),jQuery(".cancel_user_app_pending").unbind(),jQuery(".cancel_user_app_pending").on("click",function(){var e=jQuery("#sel-"+jQuery(".ga_btn_close").attr("app-id"));e.addClass("user_appointment_status_set_hide"),e.unbind();var e=jQuery(e).parent().find("span");e.removeClass("appointment_status_change_span"),e.html(jQuery(".ga_btn_close").attr("pending-string")),e.removeClass("appointment-status-green"),e.addClass("appointment-status-yellow"),e.show(),jQuery("#sel-"+jQuery(".ga_btn_close").attr("app-id")).remove()})))}).fail(function(){jQuery("form#ga_user_set_appointment_pending .ajax-response").html('<div class="ga_alert ga_alert_danger">Error sending form!</div>'),a.parent(".ga_modal_container").find(".modal_overlay").hide()})}),jQuery(document).on("submit","form#ga_reschedule_appointment",function(e){e.preventDefault();var a=jQuery(this),t=a.find("input[name=action]").val();a.parent(".ga_modal_container").find(".modal_overlay").show();var e=jQuery("form#ga_reschedule_appointment").serialize();jQuery.post(ga_update_appointment_status_obj.ajax_url,e,function(e){void 0!==e&&(a.parent(".ga_modal_container").find(".modal_overlay").hide(),0==e.success&&jQuery("form#ga_reschedule_appointment").html(e.data.message),1==e.success&&(jQuery("form#ga_reschedule_appointment").html(e.data.message),jQuery(window.appointmentID).html(e.data.app_status)))}).fail(function(){jQuery("form#ga_reschedule_appointment .ajax-response").html('<div class="ga_alert ga_alert_danger">Error sending form!</div>'),a.parent(".ga_modal_container").find(".modal_overlay").hide()})}),jQuery("body").on("click","#gappointments_calendar_slots label.time_slot",function(){var e=jQuery(this).attr("time_slot"),n,i,o,s,a,t,r,d,_,l,c,p,u,m,g,y,v,e,h;jQuery(".appointment_booking_time").val(e),jQuery("#gappointments_calendar_slots label.time_slot").each(function(){jQuery(this).removeClass("time_selected")}),jQuery(this).addClass("time_selected"),"enabled"==jQuery(this).attr("multi-select")&&(n=!0,i=jQuery("#ga_selected_bookings .ga_selected_booking"),o=jQuery(this).attr("select-max"),s=jQuery(this).attr("select-total"),a=jQuery(this).attr("time_format"),t=jQuery(this).attr("remove_am_pm"),r=jQuery(this).attr("capacity"),d=jQuery(this).attr("no_double"),_=jQuery(this).attr("slot_cost"),c=l=jQuery(".appointment_booking_date").val(),p=jQuery(".appointment_booking_time").val(),u=c+" "+p,g=m=0,jQuery(i).each(function(){var e,a,t=jQuery(this).find(".ga_selected_booking_date").val()+" "+jQuery(this).find(".ga_selected_booking_time").val();i.length>=s?n=!1:(jQuery(this).val().match(l)&&m++,"yes"==d?(t==u||o<=m)&&(n=!1):(t==u&&g++,r<=g&&(n=!1)))}),n&&(y=jQuery(this).attr("lang_slot"),v=jQuery(".appointment_booking_date").attr("name").replace("[date]","[bookings][date][]"),e=jQuery(".appointment_booking_date").attr("name").replace("[date]","[bookings][time][]"),jQuery('<div class="ga_selected_booking"><div class="ga_delete_booking"><i class="fa fa-times-circle"></i></div><input type="hidden" class="ga_hidden_input ga_selected_booking_date" name="'+v+'" value="'+c+'" slot_cost="'+_+'"><input type="hidden" class="ga_hidden_input ga_selected_booking_time" name="'+e+'" value="'+p+'" slot_cost="'+_+'">'+y+"</div></div>").hide().appendTo("#ga_selected_bookings").fadeIn(700))),j()}),jQuery("body").on("click","#ga_selected_bookings .ga_selected_booking .ga_delete_booking",function(){jQuery(this).parent(".ga_selected_booking").fadeOut(150,function(){jQuery(this).remove(),j(),jQuery("#ga_selected_bookings .ga_selected_booking .ga_delete_booking").lenght||jQuery(".appointment_booking_time").val("")})}),String.prototype.htmlEntitiesEncode=function(){return void 0!==this?this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):this}}),function(a){jQuery(document).bind("gform_post_render",function(){var e;a(".ginput_appointment_cost_input").change().each(function(){a(this).change()})})}(jQuery);
jQuery(document).on("focus",".ga-date-picker",function(){jQuery(this).datepicker({dateFormat:"yy-mm-d",showAnim:"slideDown"})}),jQuery(document).ready(function(){jQuery(document).on("submit","form#provider-schedule-update",function(e){e.preventDefault();var a=jQuery(this);a.parent(".ga_modal_container").find(".modal_overlay").show();var e=jQuery("form#provider-schedule-update").serialize();jQuery.post(ga_calendar_schedule_obj.ajax_url,e,function(e){void 0!==e&&(a.parent(".ga_modal_container").find(".modal_overlay").hide(),1==e.success&&jQuery("form#provider-schedule-update").html(e.data.html),jQuery("form#provider-schedule-update .ajax-response").html(e.data.message))}).fail(function(){jQuery("form#provider-schedule-update .ajax-response").html('<div class="ga_alert ga_alert_danger">Error sending form!</div>')})}),jQuery("body").on("click",".schedule_day .schedule_day_container .ga_add_break",function(){var e=jQuery(this).parent(".schedule_day_container").find(".schedule_week_breaks .break_time").first().clone().removeAttr("style");jQuery(this).parent(".schedule_day_container").find(".schedule_week_breaks").append(e)}),jQuery("body").on("click",".break_time .break-delete",function(){jQuery(this).parent(".break_time").fadeOut(150,function(){jQuery(this).remove()})}),jQuery("body").on("click",".provider_holidays .ga_add_holiday",function(){var e=jQuery(this).parent(".provider_holidays").find("#provider_holidays .holiday").first().clone().removeAttr("style");jQuery(this).parent(".provider_holidays").find("#provider_holidays").append(e)}),jQuery("body").on("click","#provider_holidays .holiday .holiday-delete",function(){jQuery(this).parent(".holiday").fadeOut(150,function(){jQuery(this).remove()})}),jQuery("body").on("click","#provider-schedule .ga-manage-schedule",function(e){e.preventDefault(),jQuery("html, body").addClass("ga_modal_open"),jQuery("#ga_schedule_model").removeClass("ga-hidden")}),jQuery("body").on("click","#ga_schedule_tabs span",function(){var e=jQuery(this).attr("section_go");jQuery("#ga_schedule_tabs span").removeClass("active"),jQuery(this).addClass("active"),jQuery("#ga_schedule_content .ga_schedule_content").addClass("ga-hidden"),jQuery("#"+e).removeClass("ga-hidden")}),jQuery("body").on("click","#ga_schedule_model .ga_modal_wrapper .ga_close",function(e){e.preventDefault(),jQuery(this).parents("#ga_schedule_model").fadeIn(300,function(){jQuery(this).addClass("ga-hidden"),jQuery("html, body").removeClass("ga_modal_open")})})});